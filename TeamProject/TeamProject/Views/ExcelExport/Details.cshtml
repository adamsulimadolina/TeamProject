@model TeamProject.Models.Modele_pomocnicze.ListOfFields

@{

    List<SelectListItem> tmp = ViewBag.List;
}
@Html.DropDownList("mylist", tmp,"Wybierz formularz")



<form action='@Url.Action("DownloadXlsxFile")' method="post">

    <label><strong>Wybierz kolumny do pliku</strong></label>
    @for (int i = 0; i < Model.Fields.Count(); i++)
    {

        <div class="row">
            <div class="col-md-12">

                @Html.CheckBoxFor(m => Model.Fields[i].IsCheck)
                <label class="control-label">@Model.Fields[i].NameOfField </label>
                <input asp-for="@Model.Fields[i].NameOfField" hidden />

                <input asp-for="@Model.Fields[i].IdField" hidden />

                <input asp-for="@Model.IdForm" hidden />


            </div>
        </div>

    }
    <hr />
    @Html.CheckBoxFor(m => Model.IsAllRecords, new { id = "myCheck" }) Czy chcesz otrzymać wszystkie rekordy?

    <br/>
    <label hidden id="numberOfRows"><strong>Liczba rekordów</strong></label>
    <input style="display:none" id="numberOfRecords" asp-for=@Model.NumberOfRecords placeholder="Podaj ilosc rekordow" />

    <br />
    <input asp-action="DownloadXlsxFile" type="submit" value="Pobierz Excel">
</form>


<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>

<script type="text/javascript">
    $(document).ready(function () {
        $("#mylist").change(function (event) {

            event.preventDefault();

            var selCat = $("#mylist").val();
            window.location.href = '/ExcelExport/Details/' + selCat;
        });
    });


  
    $('#myCheck').change(function () {
        var checkBox = document.getElementById("myCheck");
        var text = document.getElementById("numberOfRecords");
        var numberOfRows = document.getElementById("numberOfRows");
        if (checkBox.checked == true) {
            text.style.display = "none";
            numberOfRows.hidden = true;
        } else {
            numberOfRows.hidden = false;
            text.style.display = "block";
        }
    }
    );


</script>
